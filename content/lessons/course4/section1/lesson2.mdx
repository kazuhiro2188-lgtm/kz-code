# 正規化と非正規化

## はじめに

このレッスンでは、**正規化**と**非正規化**について学びます。

## 正規化とは

**正規化**は、データベースの設計において、データの重複を排除し、整合性を保つための手法です。

### 正規化の目的

- **データの重複排除**: 同じデータを複数箇所に保存しない
- **整合性の確保**: データの不整合を防ぐ
- **更新効率の向上**: 1箇所の更新で済む

### 正規形

正規化には、以下のような正規形があります：

1. **第1正規形（1NF）**: 各セルに1つの値のみ
2. **第2正規形（2NF）**: 部分関数従属を排除
3. **第3正規形（3NF）**: 推移的関数従属を排除
4. **ボイス・コッド正規形（BCNF）**: より厳密な正規形

## 非正規化とは

**非正規化**は、パフォーマンスを向上させるために、意図的に正規化を緩めることです。

### 非正規化の目的

- **クエリ性能の向上**: JOINの回数を減らす
- **読み取り性能の向上**: 1回のクエリで必要なデータを取得

### 非正規化の例

```sql
-- 正規化されたテーブル
users (id, name, email)
orders (id, user_id, total)
order_items (id, order_id, product_id, quantity)

-- 非正規化されたテーブル（読み取り性能向上）
orders (id, user_id, user_name, user_email, total, items_json)
```

## 正規化と非正規化のバランス

適切な設計では、正規化と非正規化のバランスが重要です：

- **書き込みが多い場合**: 正規化を重視
- **読み取りが多い場合**: 非正規化を検討
- **整合性が重要**: 正規化を重視

## AI開発における適用

AI開発においても、正規化と非正規化のバランスが重要です：

- **プロンプトテンプレート**: 正規化して再利用性を高める
- **実行履歴**: 非正規化してクエリ性能を向上
- **ユーザーデータ**: 正規化して整合性を保つ

## まとめ

- **正規化**はデータの重複を排除し、整合性を保つ
- **非正規化**はパフォーマンスを向上させる
- 適切なバランスにより、整合性とパフォーマンスを両立できる
